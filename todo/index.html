<!DOCTYPE html>
<html>
<head>
	<title>To Do: Home</title>
	<link rel="stylesheet" href="main.css">

</head>
<body>
	<div id="body-wrapper">
		<div id="nav-wrapper">
			<div><a></a></div>
			<div><a class="current">Home</a></div>
			<div><a class="link">Work</a></div>
			<div><a class="link">School</a></div>
			<div><a class="link">Family</a></div>
			<div><a class="link">Friends</a></div>
			<div><a></a></div>
		</div>
		<div id="content-wrapper">
			<div id="header-title">
				<h1>Household tasks</h1>
			</div>
			<div id="add-wrapper">
				<div id="add-todo">
					<span id="add-new" onclick="addNew()">&#43;</span>
					<input class="input-add" id="taskname">
					<p id="invisitext">dummy</p>
				</div>
			</div>
			<div id="todo-content-wrapper">
				<h1>To do:</h1>
				<div id="todo-wrapper">
					<div class="dummy-todo" id="0">
						<table class="todo-table">
							<tr>
								<td class="todo-td"><p>Fix kitchen sink</p></td>
								<td class="todo-td"><span id="delete" style="cursor:pointer">&times;</span></td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>
		<div id="myModal" class="modal">

			<div class="modal-content">
				<h1>Are you sure?</h1>
				<p>Once you delete this item, it can't be recovered.</p>
				<button id="yes" onclick="onclickyes()">Yes</button>
				<button id="no" onclick="onclickno()">No</button>
			</div>

		</div>
	</div>

<script>

	var modal = document.getElementById('myModal');
	var close = document.getElementById("delete");
	var no = document.getElementById("no")[0];
	var invisitext = document.getElementById("invisitext");
	var todowrap = document.getElementById("todo-content-wrapper");
	var parent;
	var p;

	// When the user clicks on the button, open the modal 
	close.onclick = function(e) {
		parent = e.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.id;
		//there is a very good reason for the six parentNode selectors:
		//i'm trying to get the id from the div element that wraps the entire todo structure
		//but i'm doing that from clicking on the span element
		//so i need to go back six elements (including the not seen tbody)
		//to get that id
		//because fuck me i guess
	    modal.style.display = "block";
		invisitext.innerHTML = parent;
	}
	// When the user clicks on <span> (x), close the modal
	function onclickno() {
	    modal.style.display = "none";
	}
	//this is honestly so back asswards but uhhh it works? so heck yeah
	function onclickyes(e) {
		modal.style.display = "none";
		parent = invisitext.innerHTML;
		p = parent;
		console.log(p);
		document.getElementById(p).style.display = "none";
		p.style.display = "none";
	}
	// When the user clicks anywhere outside of the modal, close it
	window.onclick = function(event) {
	    if (event.target == modal) {
	        modal.style.display = "none";
	    }
	}





	/*
	THIS IS WHAT WE'RE TRYING TO MAKE

	<div class="dummy-todo" id="0">
		<table class="todo-table">
			<tr>
				<td class="todo-td"><p>Fix kitchen sink</p></td>
				<td class="todo-td"><span id="delete" style="cursor:pointer">&times;</span></td>
			</tr>
		</table>
	</div>
	*/



	function addNew(){
		var name = document.getElementById("taskname");
		var i;
		console.log(invisitext.innerHTML);
		console.log(name.value.length);
		//var container = document.createElement




		function checker(){
			if(name.value.length <= 0){
				alert("Please fill task name field.");
				name.style.border = "2px solid red";
			}else if(name.value.length >=0){
				//logic for adding the actual todo goes here
				name.style.border = "1px solid #c4c4c4";

				if(invisitext.value = "dummy"){
					i = 1;
				}else{
					i = invisitext.value + 1;
				}

				console.log(i);

				var container = document.createElement("div");
				var tbl       = document.createElement("table");
				var tbltr     = document.createElement("tr");
				var tbltrtd1  = document.createElement("td");
				var tbltrtd4  = document.createElement("td");
				var tbltrtdp1 = document.createElement("p");
				var tbltrtdsp = document.createElement("span");







				container.className = "dummy-todo";
				container.setAttribute("id", i);
				tbl.className = "todo-table";
				tbltrtd1.className = "todo-td";
				tbltrtd4.className = "todo-td";
				tbltrtdsp.setAttribute("id", "delete");
				tbltrtdsp.style = "cursor: pointer";
				tbltrtdp1.value = name.value;
				tbltrtdsp.value = "&times;";



				tbltrtd4.append(tbltrtdsp);
				tbltrtd1.append(tbltrtdp1);
				tbltr.append(tbltrtd4);
				tbltr.append(tbltrtd1);
				tbl.append(tbltr);
				container.append(tbl);
				todowrap.appendChild(container);


				console.log(container.childNodes)
			}
		}
		checker();

		console.log(name.value);



	}


</script>


</body>
</html>